name: 'rush publish'
inputs:
  authorName:
    required: true
  authorEmail:
    required: true
  npmUsername:
    required: true
  npmPassword:
    required: true
  targetBranch:
    required: false
    default: main
env:

runs:
  using: "composite"
  steps:
    - name: Setup git user
      run: |
        git config --local user.name "${{ inputs.authorName }}"
        git config --local user.email "${{ inputs.authorEmail }}"
      shell: bash
    - name: Publish
      run: |
        node common/scripts/install-run-rush.js version --bump --target-branch ${{ inputs.targetBranch }}
        node common/scripts/install-run-rush.js publish --publish --include-all
      shell: bash
      env:
        NPM_CONFIG_NOPROXY: jfrog.teliacompany.io
        JFROG_TOKEN: ${{ inputs.npmPassword }}
        JFROG_USERNAME: ${{ inputs.npmUsername }}
